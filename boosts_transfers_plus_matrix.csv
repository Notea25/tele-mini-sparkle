Проблема;Фронт — в чём ошибка;Фронт — что нужно сделать;Бэк — в чём ошибка;Бэк — что нужно сделать
"После использования буста 'Трансферы+' фронт считает, что он активен навсегда и блокирует командные бусты";"Состояние pendingBoostId и pendingBoostPage хранится без номера тура. После применения 'transfers' вызывается setPendingBoost('transfers', 'transfers'), но нигде не вызывается markBoostAsUsed или очистка pending при смене тура. hasAnyPendingBoost и otherPageBoostActive на 'Моя команда' видят этот pending как активный буст даже в будущих турах";"Добавить в BoostState поле pendingBoostTour. При применении буста записывать туда boostTourId. При заходе на страницу или смене тура очищать pending, если pendingBoostTour не равен текущему туру, либо вызывать markBoostAsUsed('transfers', старый_тур) и затем clearPendingBoost. В hasAnyPendingBoost учитывать тур, чтобы pending считался активным только в своём туре";"Если бэк уже ограничивает применение буста одним туром и корректно отдаёт used_for_next_tour и used_in_tour_number, явной ошибки нет, проблема только во фронте";"Ничего не обязательно менять. Опционально можно добавить в ответ API явный флаг, что трансферный буст активен именно в текущем туре, чтобы фронт меньше полагался на локальное pending"
"После использования 'Трансферы+' все будущие трансферы считаются бесплатными";"В transferState persistentBoostActive опирается только на boostState.pendingBoostPage равный 'transfers' и pendingBoostId равный 'transfers' или 'golden'. Для 'transfers' pending никогда не сбрасывается, поэтому persistentBoostActive всегда true, calculateTransferCosts всегда даёт ноль штрафа, а recordTransfers не накапливает штраф и не тратит бесплатную квоту";"Привязать persistentBoostActive к туру, использовать pendingBoostTour и считать буст активным только если pendingBoostTour равен текущему туру. После завершения тура по аналогии с 'golden' вызывать markBoostAsUsed('transfers', tour) и очищать pending, чтобы в следующих турах persistentBoostActive был false. По возможности вместо своей логики использовать данные с бэка, например флаг активного буста в текущем туре";"Если бэк сам правильно считает штрафы и ограничивает действие буста одним туром, ошибки нет, но фронт своим расчётом может маскировать штраф или показывать неверную информацию";"Гарантировать на бэке, что эффект 'все трансферы бесплатны' действует только в туре активации буста и штраф считается по турам. Явно возвращать в ответах, активен ли трансферный буст в текущем туре и каков фактический штраф, чтобы фронт не переигрывал расчёты"