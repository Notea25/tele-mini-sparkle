# –°–æ—Å—Ç–æ—è–Ω–∏—è —Ç—É—Ä–æ–≤ –∏ –¥–µ–π—Å—Ç–≤–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

**–î–∞—Ç–∞:** 1 —Ñ–µ–≤—Ä–∞–ª—è 2026

## üìä –û–±–∑–æ—Ä

–¢—É—Ä –≤ —Å–∏—Å—Ç–µ–º–µ –º–æ–∂–µ—Ç –Ω–∞—Ö–æ–¥–∏—Ç—å—Å—è –≤ **3 —Å–æ—Å—Ç–æ—è–Ω–∏—è—Ö**: Previous (–ø—Ä–æ—à–µ–¥—à–∏–π), Current (—Ç–µ–∫—É—â–∏–π), Next (—Å–ª–µ–¥—É—é—â–∏–π). –°–æ—Å—Ç–æ—è–Ω–∏–µ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è **–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏** –Ω–∞ –æ—Å–Ω–æ–≤–µ –¥–∞—Ç –º–∞—Ç—á–µ–π, –ø—Ä–∏–≤—è–∑–∞–Ω–Ω—ã—Ö –∫ —Ç—É—Ä—É.

---

## üéØ –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏–π —Ç—É—Ä–∞

### –õ–æ–≥–∏–∫–∞ –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏

```python
now = datetime.utcnow().replace(tzinfo=timezone.utc)

for tour in tours:
    start_date = min(match.date for match in tour.matches)
    end_date = max(match.date for match in tour.matches)
    
    if start_date <= now <= end_date:
        # –¢–ï–ö–£–©–ò–ô –¢–£–†
        current_tour = tour
    elif end_date < now:
        # –ü–†–û–®–ï–î–®–ò–ô –¢–£–†
        previous_tours.append(tour)
    elif start_date > now:
        # –°–õ–ï–î–£–Æ–©–ò–ô –¢–£–†
        next_tours.append(tour)
```

**–ö–æ–¥:** `app/tours/services.py:137-176` (–º–µ—Ç–æ–¥ `get_previous_current_next_tour()`)

### –°–≤–æ–π—Å—Ç–≤–∞ —Ç—É—Ä–∞ (Tour model)

```python
class Tour:
    @property
    def start_date(self) -> datetime:
        # –î–∞—Ç–∞ —Å–∞–º–æ–≥–æ —Ä–∞–Ω–Ω–µ–≥–æ –º–∞—Ç—á–∞ —Ç—É—Ä–∞
        return min(match.date for match in self.matches)
    
    @property
    def end_date(self) -> datetime:
        # –î–∞—Ç–∞ —Å–∞–º–æ–≥–æ –ø–æ–∑–¥–Ω–µ–≥–æ –º–∞—Ç—á–∞ + 2 —á–∞—Å–∞
        return max(match.date for match in self.matches) + timedelta(hours=2)
    
    @property
    def deadline(self) -> datetime:
        # –î–µ–¥–ª–∞–π–Ω –¥–ª—è —Ç—Ä–∞–Ω—Å—Ñ–µ—Ä–æ–≤ = –Ω–∞—á–∞–ª–æ —Ç—É—Ä–∞ - 2 —á–∞—Å–∞
        return self.start_date - timedelta(hours=2)
```

**–ö–æ–¥:** `app/tours/models.py:91-114`

---

## üîÑ –ñ–∏–∑–Ω–µ–Ω–Ω—ã–π —Ü–∏–∫–ª —Ç—É—Ä–∞

```
   NEXT TOUR              CURRENT TOUR           PREVIOUS TOUR
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê        ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê       ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ –¢—Ä–∞–Ω—Å—Ñ–µ—Ä—ã   ‚îÇ   ‚Üí    ‚îÇ –ú–∞—Ç—á–∏ –∏–¥—É—Ç   ‚îÇ  ‚Üí    ‚îÇ –ó–∞–≤–µ—Ä—à—ë–Ω    ‚îÇ
‚îÇ —Ä–∞–∑—Ä–µ—à–µ–Ω—ã   ‚îÇ        ‚îÇ –¢—Ä–∞–Ω—Å—Ñ–µ—Ä—ã    ‚îÇ       ‚îÇ –û—á–∫–∏        ‚îÇ
‚îÇ             ‚îÇ        ‚îÇ –∑–∞–∫—Ä—ã—Ç—ã      ‚îÇ       ‚îÇ —Ñ–∏–Ω–∞–ª–∏–∑.    ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò        ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò       ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
     ‚Üë                        ‚Üë                      ‚Üë
  deadline - 2h          start_date            end_date + 2h
```

---

## üìÖ –ü–µ—Ä–µ—Ö–æ–¥—ã –º–µ–∂–¥—É —Å–æ—Å—Ç–æ—è–Ω–∏—è–º–∏

### 1. Next ‚Üí Current

**–ú–æ–º–µ–Ω—Ç –ø–µ—Ä–µ—Ö–æ–¥–∞:** `now >= tour.start_date`

**–ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç:**
- –î–µ–¥–ª–∞–π–Ω —Ç—Ä–∞–Ω—Å—Ñ–µ—Ä–æ–≤ –∏—Å—Ç—ë–∫ (`tour.deadline` –ø—Ä–æ—à—ë–ª)
- –ù–∞—á–∏–Ω–∞—é—Ç—Å—è –º–∞—Ç—á–∏ —Ç—É—Ä–∞
- –¢—Ä–∞–Ω—Å—Ñ–µ—Ä—ã –¥–ª—è —ç—Ç–æ–≥–æ —Ç—É—Ä–∞ **–ó–ê–ö–†–´–í–ê–Æ–¢–°–Ø**
- –ò–≥—Ä–æ–∫–∏ –Ω–µ –º–æ–≥—É—Ç –º–µ–Ω—è—Ç—å —Å–æ—Å—Ç–∞–≤ –¥–ª—è —Ç–µ–∫—É—â–µ–≥–æ —Ç—É—Ä–∞

**–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏:** –ü–µ—Ä–µ—Ö–æ–¥ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –º–≥–Ω–æ–≤–µ–Ω–Ω–æ –ø—Ä–∏ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–∏ `start_date`

### 2. Current ‚Üí Previous

**–ú–æ–º–µ–Ω—Ç –ø–µ—Ä–µ—Ö–æ–¥–∞:** `now > tour.end_date`

**–ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç:**
- –í—Å–µ –º–∞—Ç—á–∏ —Ç—É—Ä–∞ –∑–∞–≤–µ—Ä—à–µ–Ω—ã (+ 2 —á–∞—Å–∞ –Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫—É)
- –¢—É—Ä –ø–µ—Ä–µ—Ö–æ–¥–∏—Ç –≤ —Å—Ç–∞—Ç—É—Å "–ø—Ä–æ—à–µ–¥—à–∏–π"
- **–í–ê–ñ–ù–û:** –û—á–∫–∏ –µ—â—ë –ù–ï –Ω–∞—á–∏—Å–ª–µ–Ω—ã! –ù—É–∂–Ω–∞ —Ñ–∏–Ω–∞–ª–∏–∑–∞—Ü–∏—è.

**–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏:** –ü–µ—Ä–µ—Ö–æ–¥ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –ø—Ä–∏ `end_date + 2 hours`

### 3. –§–∏–Ω–∞–ª–∏–∑–∞—Ü–∏—è —Ç—É—Ä–∞

**–ú–æ–º–µ–Ω—Ç:** –í—ã–∑—ã–≤–∞–µ—Ç—Å—è **–≤—Ä—É—á–Ω—É—é** –∏–ª–∏ **—á–µ—Ä–µ–∑ Celery** –ø–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è —Ç—É—Ä–∞

**–ü—Ä–æ—Ü–µ—Å—Å:**
```python
finalize_tour_for_all_squads(tour_id, next_tour_id)
```

1. **–î–ª—è –≤—Å–µ—Ö –∫–æ–º–∞–Ω–¥ —Ç—É—Ä–∞:**
   - –†–∞—Å—Å—á–∏—Ç—ã–≤–∞—é—Ç—Å—è –æ—á–∫–∏ —á–µ—Ä–µ–∑ `calculate_points()`
   - –°–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ `SquadTour.points`
   - –¢—É—Ä –ø–æ–º–µ—á–∞–µ—Ç—Å—è `is_finalized = True`

2. **–°–æ–∑–¥–∞—ë—Ç—Å—è SquadTour –¥–ª—è —Å–ª–µ–¥—É—é—â–µ–≥–æ —Ç—É—Ä–∞:**
   - –ö–æ–ø–∏—Ä—É–µ—Ç—Å—è —Å–æ—Å—Ç–∞–≤ –∏–∑ —Ñ–∏–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ —Ç—É—Ä–∞
   - –°–±—Ä–∞—Å—ã–≤–∞–µ—Ç—Å—è `replacements = 2` (–±–µ—Å–ø–ª–∞—Ç–Ω—ã—Ö —Ç—Ä–∞–Ω—Å—Ñ–µ—Ä–∞)
   - –û—á–∏—â–∞—é—Ç—Å—è `points = 0` –∏ `penalty_points = 0`

**–ö–æ–¥:** `app/squads/services.py:1193-1298`

---

## üéÆ –ß—Ç–æ –º–æ–∂–µ—Ç –¥–µ–ª–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å

### 1Ô∏è‚É£ NEXT TOUR (–°–ª–µ–¥—É—é—â–∏–π —Ç—É—Ä)

**–ü–µ—Ä–∏–æ–¥:** –û—Ç –º–æ–º–µ–Ω—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è –¥–æ `deadline` (–Ω–∞—á–∞–ª–æ —Ç—É—Ä–∞ - 2 —á–∞—Å–∞)

#### ‚úÖ –†–∞–∑—Ä–µ—à–µ–Ω–æ:

| –î–µ–π—Å—Ç–≤–∏–µ | –û–ø–∏—Å–∞–Ω–∏–µ |
|----------|----------|
| **–¢—Ä–∞–Ω—Å—Ñ–µ—Ä—ã** | –ú–µ–Ω—è—Ç—å –∏–≥—Ä–æ–∫–æ–≤ –æ—Å–Ω–æ–≤—ã –∏ —Å–∫–∞–º–µ–π–∫–∏ |
| **–°–º–µ–Ω–∞ –∫–∞–ø–∏—Ç–∞–Ω–∞** | –ù–∞–∑–Ω–∞—á–∞—Ç—å –Ω–æ–≤–æ–≥–æ –∫–∞–ø–∏—Ç–∞–Ω–∞/–≤–∏—Ü–µ-–∫–∞–ø–∏—Ç–∞–Ω–∞ |
| **–ü—Ä–æ—Å–º–æ—Ç—Ä —Å–æ—Å—Ç–∞–≤–∞** | –í–∏–¥–µ—Ç—å —Ç–µ–∫—É—â–∏–π —Å–æ—Å—Ç–∞–≤ –¥–ª—è —Å–ª–µ–¥—É—é—â–µ–≥–æ —Ç—É—Ä–∞ |
| **–ê–∫—Ç–∏–≤–∞—Ü–∏—è –±—É—Å—Ç–æ–≤** | –ê–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å —á–∏–ø-–±—É—Å—Ç—ã (3x Captain, Double Power, etc.) |
| **–ü–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ** | –ú–Ω–æ–≥–æ–∫—Ä–∞—Ç–Ω–æ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å —Å–æ—Å—Ç–∞–≤ –¥–æ –¥–µ–¥–ª–∞–π–Ω–∞ |

**–õ–∏–º–∏—Ç—ã:**
- **2 –±–µ—Å–ø–ª–∞—Ç–Ω—ã—Ö —Ç—Ä–∞–Ω—Å—Ñ–µ—Ä–∞** –∑–∞ —Ç—É—Ä
- –ö–∞–∂–¥—ã–π —Å–ª–µ–¥—É—é—â–∏–π —Ç—Ä–∞–Ω—Å—Ñ–µ—Ä ‚Üí **-4 –æ—á–∫–∞** —à—Ç—Ä–∞—Ñ–∞
- –®—Ç—Ä–∞—Ñ –¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è **—Å—Ä–∞–∑—É** –≤ `SquadTour.penalty_points`

**–£—Å–ª–æ–≤–∏–µ:** `now < tour.deadline` (–¥–µ–¥–ª–∞–π–Ω –µ—â—ë –Ω–µ –ø—Ä–æ—à—ë–ª)

**–ö–æ–¥ –ø—Ä–æ–≤–µ—Ä–∫–∏:**
```python
# –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –¥–æ—Å—Ç—É–ø–Ω–æ–≥–æ —Ç—É—Ä–∞ –¥–ª—è —Ç—Ä–∞–Ω—Å—Ñ–µ—Ä–æ–≤
if current_tour and current_tour.deadline > now:
    target_tour = current_tour  # –ú–æ–∂–Ω–æ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å
elif next_tour and next_tour.deadline > now:
    target_tour = next_tour     # –ú–æ–∂–Ω–æ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å
else:
    raise HTTPException("No open tour available for transfers")
```

**–ö–æ–¥:** `app/squads/services.py:967-983`

#### ‚ùå –ó–∞–ø—Ä–µ—â–µ–Ω–æ:

- –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å —Å–æ—Å—Ç–∞–≤—ã –ø—Ä–æ—à–µ–¥—à–∏—Ö —Ç—É—Ä–æ–≤
- –í–∏–¥–µ—Ç—å –Ω–∞—á–∏—Å–ª–µ–Ω–Ω—ã–µ –æ—á–∫–∏ (—Ç—É—Ä –µ—â—ë –Ω–µ –Ω–∞—á–∞–ª—Å—è)

---

### 2Ô∏è‚É£ CURRENT TOUR (–¢–µ–∫—É—â–∏–π —Ç—É—Ä)

**–ü–µ—Ä–∏–æ–¥:** –û—Ç `start_date` –¥–æ `end_date + 2h`

#### ‚úÖ –†–∞–∑—Ä–µ—à–µ–Ω–æ:

| –î–µ–π—Å—Ç–≤–∏–µ | –û–ø–∏—Å–∞–Ω–∏–µ |
|----------|----------|
| **–ü—Ä–æ—Å–º–æ—Ç—Ä live-–æ—á–∫–æ–≤** | –í–∏–¥–µ—Ç—å –æ—á–∫–∏ –∏–≥—Ä–æ–∫–æ–≤ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏ –ø–æ –º–µ—Ä–µ –º–∞—Ç—á–µ–π |
| **–ü—Ä–æ—Å–º–æ—Ç—Ä —Å–æ—Å—Ç–∞–≤–∞** | –í–∏–¥–µ—Ç—å **–∑–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–π** —Å–æ—Å—Ç–∞–≤ –Ω–∞ —ç—Ç–æ—Ç —Ç—É—Ä |
| **–¢—Ä–∞–Ω—Å—Ñ–µ—Ä—ã –¥–ª—è NEXT** | –î–µ–ª–∞—Ç—å —Ç—Ä–∞–Ω—Å—Ñ–µ—Ä—ã –¥–ª—è **—Å–ª–µ–¥—É—é—â–µ–≥–æ** —Ç—É—Ä–∞ (–µ—Å–ª–∏ –µ–≥–æ –¥–µ–¥–ª–∞–π–Ω –Ω–µ –ø—Ä–æ—à—ë–ª) |

#### ‚ùå –ó–∞–ø—Ä–µ—â–µ–Ω–æ:

| –î–µ–π—Å—Ç–≤–∏–µ | –ü—Ä–∏—á–∏–Ω–∞ |
|----------|---------|
| **–¢—Ä–∞–Ω—Å—Ñ–µ—Ä—ã –¥–ª—è —Ç–µ–∫—É—â–µ–≥–æ —Ç—É—Ä–∞** | –î–µ–¥–ª–∞–π–Ω –ø—Ä–æ—à—ë–ª, —Å–æ—Å—Ç–∞–≤ –∑–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω |
| **–°–º–µ–Ω–∞ –∫–∞–ø–∏—Ç–∞–Ω–∞** | –¢–æ–ª—å–∫–æ –¥–ª—è —Å–ª–µ–¥—É—é—â–µ–≥–æ —Ç—É—Ä–∞ |
| **–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–æ—Å—Ç–∞–≤–∞** | –¢—É—Ä —É–∂–µ –∏–¥—ë—Ç, –∏–∑–º–µ–Ω–µ–Ω–∏—è –Ω–µ–≤–æ–∑–º–æ–∂–Ω—ã |

**–û—à–∏–±–∫–∞ –ø—Ä–∏ –ø–æ–ø—ã—Ç–∫–µ:**
```python
if squad_tour.is_finalized:
    raise HTTPException(400, "Cannot edit finalized tour")
```

**–ö–æ–¥:** `app/squads/services.py:1009-1013`

**–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ:** –û—á–∫–∏ –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏, –Ω–æ **–Ω–µ —Ñ–∏–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω—ã**. –û—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã–π –ø–æ–¥—Å—á—ë—Ç –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç —Ç–æ–ª—å–∫–æ –ø–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è —Ç—É—Ä–∞.

---

### 3Ô∏è‚É£ PREVIOUS TOUR (–ü—Ä–æ—à–µ–¥—à–∏–π —Ç—É—Ä)

**–ü–µ—Ä–∏–æ–¥:** –ü–æ—Å–ª–µ `end_date + 2h` –∏ —Ñ–∏–Ω–∞–ª–∏–∑–∞—Ü–∏–∏

#### ‚úÖ –†–∞–∑—Ä–µ—à–µ–Ω–æ:

| –î–µ–π—Å—Ç–≤–∏–µ | –û–ø–∏—Å–∞–Ω–∏–µ |
|----------|----------|
| **–ü—Ä–æ—Å–º–æ—Ç—Ä –∏—Å—Ç–æ—Ä–∏–∏** | –í–∏–¥–µ—Ç—å —Å–æ—Å—Ç–∞–≤, –æ—á–∫–∏, —à—Ç—Ä–∞—Ñ—ã –∑–∞ –∑–∞–≤–µ—Ä—à—ë–Ω–Ω—ã–π —Ç—É—Ä |
| **–ü—Ä–æ—Å–º–æ—Ç—Ä –ª–∏–¥–µ—Ä–±–æ—Ä–¥–∞** | –°—Ä–∞–≤–Ω–∏–≤–∞—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã —Å –¥—Ä—É–≥–∏–º–∏ –∫–æ–º–∞–Ω–¥–∞–º–∏ |
| **–ê–Ω–∞–ª–∏–∑ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏** | –î–µ—Ç–∞–ª—å–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∏–≥—Ä–æ–∫–æ–≤ –∑–∞ —Ç—É—Ä |

#### ‚ùå –ó–∞–ø—Ä–µ—â–µ–Ω–æ:

| –î–µ–π—Å—Ç–≤–∏–µ | –ü—Ä–∏—á–∏–Ω–∞ |
|----------|---------|
| **–õ—é–±—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è** | –¢—É—Ä —Ñ–∏–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω, —Å–æ—Å—Ç–∞–≤ ‚Äî –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–π —Å–Ω–∞–ø—à–æ—Ç |
| **–¢—Ä–∞–Ω—Å—Ñ–µ—Ä—ã** | –¢–æ–ª—å–∫–æ –¥–ª—è –±—É–¥—É—â–∏—Ö —Ç—É—Ä–æ–≤ |

**–°–æ—Å—Ç–æ—è–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö:**
- `SquadTour.is_finalized = True`
- `SquadTour.points` ‚Äî **–ó–ê–§–ò–ö–°–ò–†–û–í–ê–ù–´** –Ω–∞–≤—Å–µ–≥–¥–∞
- `SquadTour.penalty_points` ‚Äî —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã
- –°–æ—Å—Ç–∞–≤ –∏–≥—Ä–æ–∫–æ–≤ ‚Äî –Ω–µ–∏–∑–º–µ–Ω–Ω—ã–π –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–π —Å–Ω–∞–ø—à–æ—Ç

---

## ‚è∞ –î–µ–¥–ª–∞–π–Ω –∏ —Ç—Ä–∞–Ω—Å—Ñ–µ—Ä—ã

### –†–∞—Å—á—ë—Ç –¥–µ–¥–ª–∞–π–Ω–∞

```python
deadline = tour.start_date - timedelta(hours=2)
```

**–ü—Ä–∏–º–µ—Ä:**
- –ü–µ—Ä–≤—ã–π –º–∞—Ç—á —Ç—É—Ä–∞: **15:00 (—Å—É–±–±–æ—Ç–∞)**
- **–î–µ–¥–ª–∞–π–Ω —Ç—Ä–∞–Ω—Å—Ñ–µ—Ä–æ–≤: 13:00 (—Å—É–±–±–æ—Ç–∞)**

### –õ–æ–≥–∏–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ —Ç—Ä–∞–Ω—Å—Ñ–µ—Ä–æ–≤

```python
def can_make_transfers(tour):
    now = datetime.now(timezone.utc)
    
    # –ü—Ä–æ–≤–µ—Ä–∫–∞ 1: –î–µ–¥–ª–∞–π–Ω –Ω–µ –ø—Ä–æ—à—ë–ª
    if tour.deadline <= now:
        return False, "Deadline has passed"
    
    # –ü—Ä–æ–≤–µ—Ä–∫–∞ 2: –¢—É—Ä –Ω–µ —Ñ–∏–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω
    if squad_tour.is_finalized:
        return False, "Tour is finalized"
    
    return True, "Transfers available"
```

**–ö–æ–¥:** `app/squads/services.py:1009-1013, 974-983`

---

## üèÜ –ù–∞—á–∏—Å–ª–µ–Ω–∏–µ –æ—á–∫–æ–≤ –≤ Total Points

### –ö–æ–≥–¥–∞ –æ—á–∫–∏ –ø–µ—Ä–µ—Ö–æ–¥—è—Ç –≤ –æ–±—â–∏–π —Å—á—ë—Ç?

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  1. –¢—É—Ä –∑–∞–≤–µ—Ä—à—ë–Ω (end_date + 2h –ø—Ä–æ—à–ª–æ)                  ‚îÇ
‚îÇ     ‚Üì                                                     ‚îÇ
‚îÇ  2. finalize_tour_for_all_squads() –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è            ‚îÇ
‚îÇ     ‚Üì                                                     ‚îÇ
‚îÇ  3. calculate_points() ‚Üí SquadTour.points                ‚îÇ
‚îÇ     ‚Üì                                                     ‚îÇ
‚îÇ  4. is_finalized = True                                  ‚îÇ
‚îÇ     ‚Üì                                                     ‚îÇ
‚îÇ  5. ‚úÖ –û–ß–ö–ò –û–§–ò–¶–ò–ê–õ–¨–ù–û –ù–ê–ß–ò–°–õ–ï–ù–´ –í TOTAL                 ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

### –î–æ —Ñ–∏–Ω–∞–ª–∏–∑–∞—Ü–∏–∏

**–û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ:**
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–∏–¥–∏—Ç **live-–æ—á–∫–∏** –∏–≥—Ä–æ–∫–æ–≤
- –û—á–∫–∏ **–Ω–µ —É—á–∏—Ç—ã–≤–∞—é—Ç—Å—è** –≤ `Total Points`
- –õ–∏–¥–µ—Ä–±–æ—Ä–¥ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –æ—á–∫–∏ **–ø—Ä–µ–¥—ã–¥—É—â–∏—Ö** —Ç—É—Ä–æ–≤

**–°—Ç–∞—Ç—É—Å:**
- `SquadTour.is_finalized = False`
- `SquadTour.points = 0` (–∏–ª–∏ —Å—Ç–∞—Ä–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ)

### –ü–æ—Å–ª–µ —Ñ–∏–Ω–∞–ª–∏–∑–∞—Ü–∏–∏

**–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ:**
```python
# 1. –†–∞—Å—Å—á–∏—Ç—ã–≤–∞—é—Ç—Å—è –æ—á–∫–∏
squad_tour.points = await calculate_points(session)

# 2. –¢—É—Ä –ø–æ–º–µ—á–∞–µ—Ç—Å—è –∫–∞–∫ —Ñ–∏–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π
squad_tour.is_finalized = True

# 3. –û—á–∫–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤–∫–ª—é—á–∞—é—Ç—Å—è –≤ Total
total_earned = SUM(SquadTour.points WHERE squad_id = X)
```

**–ö–æ–¥:** `app/squads/services.py:1227-1235`

**–õ–∏–¥–µ—Ä–±–æ—Ä–¥ –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è:**
- `total_points` = —Å—É–º–º–∞ –≤—Å–µ—Ö —Ñ–∏–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö `SquadTour.points`
- `total_penalty_points` = —Å—É–º–º–∞ –≤—Å–µ—Ö `SquadTour.penalty_points`
- `total_net` = `total_points - total_penalty_points`

---

## üîê –ó–∞—â–∏—Ç–∞ –æ—Ç –∏–∑–º–µ–Ω–µ–Ω–∏–π

### –£—Ä–æ–≤–µ–Ω—å 1: Deadline check

```python
if tour.deadline <= now:
    raise HTTPException(400, "Deadline has passed")
```

### –£—Ä–æ–≤–µ–Ω—å 2: Finalized check

```python
if squad_tour.is_finalized:
    raise HTTPException(400, "Cannot edit finalized tour")
```

### –£—Ä–æ–≤–µ–Ω—å 3: Tour availability

```python
if not target_tour:
    raise HTTPException(400, "No open tour available for transfers")
```

**–ö–æ–¥:** `app/squads/services.py:979-983, 1009-1013`

---

## üìä API –≠–Ω–¥–ø–æ–∏–Ω—Ç—ã –∏ —Å–æ—Å—Ç–æ—è–Ω–∏—è

### –ü–æ–ª—É—á–∏—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Ç—É—Ä–∞—Ö

```
GET /api/tours/get_previous_current_next_tour/{league_id}
```

**–û—Ç–≤–µ—Ç:**
```json
{
  "previous_tour": {
    "id": 5,
    "number": 5,
    "type": "previous",
    "start_date": "2026-01-20T15:00:00Z",
    "end_date": "2026-01-22T21:00:00Z",
    "deadline": "2026-01-20T13:00:00Z"
  },
  "current_tour": {
    "id": 6,
    "number": 6,
    "type": "current",
    "start_date": "2026-01-27T15:00:00Z",
    "end_date": "2026-01-29T21:00:00Z",
    "deadline": "2026-01-27T13:00:00Z"
  },
  "next_tour": {
    "id": 7,
    "number": 7,
    "type": "next",
    "start_date": "2026-02-03T15:00:00Z",
    "end_date": "2026-02-05T21:00:00Z",
    "deadline": "2026-02-03T13:00:00Z"
  }
}
```

### –°–¥–µ–ª–∞—Ç—å —Ç—Ä–∞–Ω—Å—Ñ–µ—Ä—ã

```
POST /api/squad_tours/squad/{squad_id}/replace_players
```

**–õ–æ–≥–∏–∫–∞:**
1. –û–ø—Ä–µ–¥–µ–ª—è–µ—Ç –¥–æ—Å—Ç—É–ø–Ω—ã–π —Ç—É—Ä: `current_tour` (–µ—Å–ª–∏ –¥–µ–¥–ª–∞–π–Ω –Ω–µ –ø—Ä–æ—à—ë–ª) –∏–ª–∏ `next_tour`
2. –ü—Ä–æ–≤–µ—Ä—è–µ—Ç `deadline > now`
3. –ü—Ä–æ–≤–µ—Ä—è–µ—Ç `is_finalized == False`
4. –ü—Ä–∏–º–µ–Ω—è–µ—Ç —Ç—Ä–∞–Ω—Å—Ñ–µ—Ä—ã –∫ –Ω–∞–π–¥–µ–Ω–Ω–æ–º—É —Ç—É—Ä—É

---

## üéØ –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–∏–º–µ—Ä—ã

### –°—Ü–µ–Ω–∞—Ä–∏–π 1: –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –¥–µ–ª–∞–µ—Ç —Ç—Ä–∞–Ω—Å—Ñ–µ—Ä—ã

**–í—Ä–µ–º—è:** –ü–æ–Ω–µ–¥–µ–ª—å–Ω–∏–∫, 10:00  
**–¢–µ–∫—É—â–∏–π —Ç—É—Ä:** –¢—É—Ä 6 (–º–∞—Ç—á–∏ –≤ —Å—É–±–±–æ—Ç—É 15:00)  
**–î–µ–¥–ª–∞–π–Ω:** –°—É–±–±–æ—Ç–∞ 13:00

‚úÖ **–î–æ—Å—Ç—É–ø–Ω–æ:**
- –î–µ–ª–∞—Ç—å —Ç—Ä–∞–Ω—Å—Ñ–µ—Ä—ã –¥–ª—è –¢—É—Ä–∞ 6
- –ú–µ–Ω—è—Ç—å –∫–∞–ø–∏—Ç–∞–Ω–∞
- –ê–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å –±—É—Å—Ç—ã
- –ú–Ω–æ–≥–æ–∫—Ä–∞—Ç–Ω–æ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å —Å–æ—Å—Ç–∞–≤

‚ùå **–ù–µ–¥–æ—Å—Ç—É–ø–Ω–æ:**
- –ú–µ–Ω—è—Ç—å —Å–æ—Å—Ç–∞–≤ –¢—É—Ä–∞ 5 (—Ñ–∏–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω)

---

### –°—Ü–µ–Ω–∞—Ä–∏–π 2: –ù–∞—Å—Ç—É–ø–∏–ª –¥–µ–¥–ª–∞–π–Ω

**–í—Ä–µ–º—è:** –°—É–±–±–æ—Ç–∞, 13:00  
**–°—Ç–∞—Ç—É—Å:** –î–µ–¥–ª–∞–π–Ω –¢—É—Ä–∞ 6 –∏—Å—Ç—ë–∫

‚úÖ **–î–æ—Å—Ç—É–ø–Ω–æ:**
- –ü—Ä–æ—Å–º–∞—Ç—Ä–∏–≤–∞—Ç—å –∑–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Å–æ—Å—Ç–∞–≤ –¢—É—Ä–∞ 6
- –î–µ–ª–∞—Ç—å —Ç—Ä–∞–Ω—Å—Ñ–µ—Ä—ã –¥–ª—è **–¢—É—Ä–∞ 7** (—Å–ª–µ–¥—É—é—â–∏–π)

‚ùå **–ù–µ–¥–æ—Å—Ç—É–ø–Ω–æ:**
- –ú–µ–Ω—è—Ç—å —Å–æ—Å—Ç–∞–≤ –¢—É—Ä–∞ 6 (–¥–µ–¥–ª–∞–π–Ω –ø—Ä–æ—à—ë–ª)

**–û—à–∏–±–∫–∞:**
```json
{
  "status_code": 400,
  "detail": "No open tour available for transfers"
}
```

---

### –°—Ü–µ–Ω–∞—Ä–∏–π 3: –¢—É—Ä –∑–∞–≤–µ—Ä—à—ë–Ω

**–í—Ä–µ–º—è:** –í–æ—Å–∫—Ä–µ—Å–µ–Ω—å–µ, 23:00  
**–°—Ç–∞—Ç—É—Å:** –í—Å–µ –º–∞—Ç—á–∏ –¢—É—Ä–∞ 6 –∑–∞–≤–µ—Ä—à–µ–Ω—ã (end_date –ø—Ä–æ—à–ª–∞)

‚è≥ **–î–æ —Ñ–∏–Ω–∞–ª–∏–∑–∞—Ü–∏–∏:**
- `SquadTour.is_finalized = False`
- –û—á–∫–∏ –≤–∏–¥–Ω—ã, –Ω–æ **–Ω–µ —É—á–∏—Ç—ã–≤–∞—é—Ç—Å—è** –≤ Total
- –õ–∏–¥–µ—Ä–±–æ—Ä–¥ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Å—Ç–∞—Ä—ã–µ –¥–∞–Ω–Ω—ã–µ

‚úÖ **–ü–æ—Å–ª–µ –≤—ã–∑–æ–≤–∞ `finalize_tour(tour_id=6)`:**
- `SquadTour.is_finalized = True`
- –û—á–∫–∏ **–û–§–ò–¶–ò–ê–õ–¨–ù–û** –¥–æ–±–∞–≤–ª–µ–Ω—ã –≤ Total Points
- –õ–∏–¥–µ—Ä–±–æ—Ä–¥ –æ–±–Ω–æ–≤–ª—ë–Ω
- –°–æ–∑–¥–∞–Ω SquadTour –¥–ª—è –¢—É—Ä–∞ 7

---

### –°—Ü–µ–Ω–∞—Ä–∏–π 4: –§–∏–Ω–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–æ—à–µ–¥—à–µ–≥–æ —Ç—É—Ä–∞

**–î–µ–π—Å—Ç–≤–∏–µ:** –ê–¥–º–∏–Ω –≤—ã–∑—ã–≤–∞–µ—Ç —Ñ–∏–Ω–∞–ª–∏–∑–∞—Ü–∏—é

```python
await SquadService.finalize_tour_for_all_squads(
    tour_id=6,
    next_tour_id=7
)
```

**–ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç:**

1. **–î–ª—è –∫–∞–∂–¥–æ–≥–æ SquadTour (–¢—É—Ä 6):**
   - –†–∞—Å—Å—á–∏—Ç—ã–≤–∞—é—Ç—Å—è –æ—á–∫–∏ –≤—Å–µ—Ö 15 –∏–≥—Ä–æ–∫–æ–≤
   - `points = 45` (–ø—Ä–∏–º–µ—Ä)
   - `is_finalized = True`

2. **–°–æ–∑–¥–∞—ë—Ç—Å—è SquadTour –¥–ª—è –¢—É—Ä–∞ 7:**
   - –ö–æ–ø–∏—Ä—É–µ—Ç—Å—è —Å–æ—Å—Ç–∞–≤ –∏–∑ –¢—É—Ä–∞ 6
   - `replacements = 2` (—Å–±—Ä–æ—à–µ–Ω–æ)
   - `points = 0`
   - `penalty_points = 0`

3. **–û–±–Ω–æ–≤–ª—è–µ—Ç—Å—è Total Points:**
   - Old: `total_earned = 135` (—Ç—É—Ä—ã 1-5)
   - New: `total_earned = 180` (—Ç—É—Ä—ã 1-6)

**–ö–æ–¥:** `app/squads/services.py:1226-1285`

---

## üìã –¢–∞–±–ª–∏—Ü–∞ —Å–æ—Å—Ç–æ—è–Ω–∏–π

| –°–æ—Å—Ç–æ—è–Ω–∏–µ | –ü–µ—Ä–∏–æ–¥ | –¢—Ä–∞–Ω—Å—Ñ–µ—Ä—ã | –û—á–∫–∏ –≤ Total | is_finalized |
|-----------|--------|-----------|--------------|--------------|
| **Next Tour** | `now < start_date - 2h` | ‚úÖ –î–æ—Å—Ç—É–ø–Ω—ã | ‚ùå –ù–µ—Ç | `False` |
| **Current Tour** | `start_date <= now <= end_date` | ‚ùå –ó–∞–∫—Ä—ã—Ç—ã | ‚è≥ Live (–Ω–µ —É—á—Ç–µ–Ω—ã) | `False` |
| **Previous (–Ω–µ —Ñ–∏–Ω–∞–ª–∏–∑.)** | `end_date < now` | ‚ùå –ó–∞–∫—Ä—ã—Ç—ã | ‚è≥ –í–∏–¥–Ω—ã, –Ω–µ —É—á—Ç–µ–Ω—ã | `False` |
| **Previous (—Ñ–∏–Ω–∞–ª–∏–∑.)** | –ü–æ—Å–ª–µ `finalize_tour()` | ‚ùå –ó–∞–∫—Ä—ã—Ç—ã | ‚úÖ –ù–∞—á–∏—Å–ª–µ–Ω—ã –≤ Total | `True` |

---

## üîÆ –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è (–±—É–¥—É—â–µ–µ)

### Celery Tasks

```python
# –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Ñ–∏–Ω–∞–ª–∏–∑–∞—Ü–∏—è —Ç—É—Ä–æ–≤
@celery.task
def auto_finalize_completed_tours():
    now = datetime.utcnow()
    
    # –ù–∞–π—Ç–∏ –≤—Å–µ —Ç—É—Ä—ã, –∫–æ—Ç–æ—Ä—ã–µ –∑–∞–≤–µ—Ä—à–∏–ª–∏—Å—å > 2 —á–∞—Å–æ–≤ –Ω–∞–∑–∞–¥
    completed_tours = Tour.query.filter(
        Tour.end_date + timedelta(hours=2) < now,
        Tour.is_finalized == False
    ).all()
    
    for tour in completed_tours:
        finalize_tour_for_all_squads(tour.id, tour.next_tour_id)
```

**–ü–ª–∞–Ω–∏—Ä—É–µ—Ç—Å—è:** –ó–∞–ø—É—Å–∫ –∫–∞–∂–¥—ã–µ 30 –º–∏–Ω—É—Ç —á–µ—Ä–µ–∑ Celery Beat

---

## ‚úÖ –ò—Ç–æ–≥–æ–≤–∞—è —Å—Ö–µ–º–∞

```
–°–û–ó–î–ê–ù–ò–ï –ö–û–ú–ê–ù–î–´
   ‚Üì
[Next Tour] ‚Äî –¢—Ä–∞–Ω—Å—Ñ–µ—Ä—ã —Ä–∞–∑—Ä–µ—à–µ–Ω—ã (deadline –Ω–µ –ø—Ä–æ—à—ë–ª)
   ‚Üì (–¥–æ—Å—Ç–∏–≥–Ω—É—Ç start_date)
[Current Tour] ‚Äî –ú–∞—Ç—á–∏ –∏–¥—É—Ç, —Ç—Ä–∞–Ω—Å—Ñ–µ—Ä—ã –∑–∞–∫—Ä—ã—Ç—ã
   ‚Üì (–¥–æ—Å—Ç–∏–≥–Ω—É—Ç end_date + 2h)
[Previous Tour] ‚Äî –ó–∞–≤–µ—Ä—à—ë–Ω, —Ñ–∏–Ω–∞–ª–∏–∑–∞—Ü–∏—è –æ–∂–∏–¥–∞–µ—Ç—Å—è
   ‚Üì (–≤—ã–∑–≤–∞–Ω finalize_tour())
[Finalized Tour] ‚Äî –û—á–∫–∏ –Ω–∞—á–∏—Å–ª–µ–Ω—ã –≤ Total, is_finalized=True
   ‚Üì
–°–æ–∑–¥–∞–Ω SquadTour –¥–ª—è —Å–ª–µ–¥—É—é—â–µ–≥–æ —Ç—É—Ä–∞
   ‚Üì
–¶–ò–ö–õ –ü–û–í–¢–û–†–Ø–ï–¢–°–Ø
```

---

## üìù –ö–ª—é—á–µ–≤—ã–µ —Ñ–∞–π–ª—ã

### Backend
- `app/tours/models.py:91-114` ‚Äî —Å–≤–æ–π—Å—Ç–≤–∞ —Ç—É—Ä–∞ (start_date, end_date, deadline)
- `app/tours/services.py:137-176` ‚Äî –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ previous/current/next
- `app/squads/services.py:941-1127` ‚Äî –ª–æ–≥–∏–∫–∞ —Ç—Ä–∞–Ω—Å—Ñ–µ—Ä–æ–≤ –∏ –ø—Ä–æ–≤–µ—Ä–∫–∞ –¥–µ–¥–ª–∞–π–Ω–∞
- `app/squads/services.py:1193-1298` ‚Äî —Ñ–∏–Ω–∞–ª–∏–∑–∞—Ü–∏—è —Ç—É—Ä–∞

### Frontend
- `src/lib/api.ts:138-163` ‚Äî —Ç–∏–ø—ã TourInfo —Å –ø–æ–ª—è–º–∏ type
- API —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏–π —Ç—É—Ä–æ–≤

---

## üéØ –ì–ª–∞–≤–Ω—ã–µ –º–æ–º–µ–Ω—Ç—ã

‚úÖ **–°–æ—Å—Ç–æ—è–Ω–∏–µ —Ç—É—Ä–∞** –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è **–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏** –ø–æ –¥–∞—Ç–∞–º –º–∞—Ç—á–µ–π  
‚úÖ **–î–µ–¥–ª–∞–π–Ω** = –Ω–∞—á–∞–ª–æ —Ç—É—Ä–∞ - 2 —á–∞—Å–∞  
‚úÖ **–¢—Ä–∞–Ω—Å—Ñ–µ—Ä—ã** –¥–æ—Å—Ç—É–ø–Ω—ã —Ç–æ–ª—å–∫–æ –¥–æ –¥–µ–¥–ª–∞–π–Ω–∞ (–¥–ª—è next/current —Å –æ—Ç–∫—Ä—ã—Ç—ã–º deadline)  
‚úÖ **–û—á–∫–∏ –Ω–∞—á–∏—Å–ª—è—é—Ç—Å—è** —Ç–æ–ª—å–∫–æ –ø–æ—Å–ª–µ **—Ñ–∏–Ω–∞–ª–∏–∑–∞—Ü–∏–∏** —Ç—É—Ä–∞ (`is_finalized = True`)  
‚úÖ **Total Points** –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è **–º–≥–Ω–æ–≤–µ–Ω–Ω–æ** –ø—Ä–∏ —Ñ–∏–Ω–∞–ª–∏–∑–∞—Ü–∏–∏  
‚úÖ **–ü—Ä–æ—à–µ–¥—à–∏–µ —Ç—É—Ä—ã** ‚Äî —Ç–æ–ª—å–∫–æ –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ (read-only)  
‚úÖ **is_finalized** ‚Äî –∫–ª—é—á–µ–≤–æ–π —Ñ–ª–∞–≥ –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è, —É—á—Ç–µ–Ω—ã –ª–∏ –æ—á–∫–∏
